0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP DATABASE IF EXISTS team29_projectdb CASCADE;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE DATABASE team29_projectdb LOCATION "project/hive/warehouse";
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team29_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- city table
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE city STORED AS AVRO LOCATION 'project/warehouse/city'
. . . . . . . . . . . . . . . . . . . . . . .> TBLPROPERTIES ('avro.schema.url'='project/warehouse/avsc/city.avsc');
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- dataset table
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE dataset STORED AS AVRO LOCATION 'project/warehouse/dataset'
. . . . . . . . . . . . . . . . . . . . . . .> TBLPROPERTIES ('avro.schema.url'='project/warehouse/avsc/dataset.avsc');
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM city LIMIT 50;
+---------------+-----------------+
| city.city_id  | city.city_name  |
+---------------+-----------------+
| 1             | bengaluru       |
| 2             | nagpur          |
| 3             | jaipur          |
| 4             | kanpur          |
| 5             | hyderabad       |
| 6             | delhi           |
| 7             | pune            |
| 8             | bombay          |
+---------------+-----------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM dataset LIMIT 50;
+--------------------+-------------------+-------------------+---------------------+-------------------+---------------------+---------------------+----------------------------+-------------------+------------------+------------------+-----------------+--------------------+---------------------+---------------------+---------------------+--------------------+---------------------+-------------------+-----------------+-------------------+---------------+---------------------+-------------------+---------------------+------------------+
| dataset.date_time  | dataset.max_temp  | dataset.min_temp  | dataset.total_snow  | dataset.sun_hour  | dataset.uv_index_1  | dataset.uv_index_2  | dataset.moon_illumunation  | dataset.moonrise  | dataset.moonset  | dataset.sunrise  | dataset.sunset  | dataset.dew_point  | dataset.feels_like  | dataset.heat_index  | dataset.wind_chill  | dataset.wind_gust  | dataset.cloudcover  | dataset.humidity  | dataset.precip  | dataset.pressure  | dataset.temp  | dataset.visivility  | dataset.wind_dir  | dataset.wind_speed  | dataset.city_id  |
+--------------------+-------------------+-------------------+---------------------+-------------------+---------------------+---------------------+----------------------------+-------------------+------------------+------------------+-----------------+--------------------+---------------------+---------------------+---------------------+--------------------+---------------------+-------------------+-----------------+-------------------+---------------+---------------------+-------------------+---------------------+------------------+
| 1230757200000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 16                 | 18                  | 18                  | 18                  | 11                 | 2                   | 91                | 0.00000         | 1014              | 14            | 10                  | 109               | 8                   | 1                |
| 1230760800000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 16                 | 17                  | 17                  | 17                  | 9                  | 2                   | 93                | 0.00000         | 1014              | 14            | 7                   | 85                | 6                   | 1                |
| 1230764400000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 15                 | 16                  | 16                  | 16                  | 7                  | 2                   | 94                | 0.00000         | 1014              | 13            | 5                   | 61                | 4                   | 1                |
| 1230768000000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 15                 | 15                  | 15                  | 15                  | 5                  | 2                   | 96                | 0.00000         | 1014              | 12            | 2                   | 37                | 3                   | 1                |
| 1230771600000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 15                 | 18                  | 18                  | 18                  | 5                  | 1                   | 88                | 0.00000         | 1015              | 14            | 5                   | 45                | 3                   | 1                |
| 1230775200000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 16                 | 20                  | 22                  | 20                  | 5                  | 1                   | 80                | 0.00000         | 1016              | 16            | 7                   | 53                | 3                   | 1                |
| 1230778800000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 5                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 17                 | 23                  | 25                  | 23                  | 4                  | 0                   | 72                | 0.00000         | 1016              | 18            | 10                  | 61                | 4                   | 1                |
| 1230782400000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 6                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 16                 | 24                  | 26                  | 24                  | 6                  | 0                   | 61                | 0.00000         | 1016              | 21            | 10                  | 65                | 5                   | 1                |
| 1230786000000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 6                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 14                 | 27                  | 27                  | 26                  | 7                  | 0                   | 49                | 0.00000         | 1015              | 23            | 10                  | 70                | 6                   | 1                |
| 1230789600000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 7                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 12                 | 28                  | 28                  | 28                  | 8                  | 0                   | 37                | 0.00000         | 1014              | 25            | 10                  | 75                | 7                   | 1                |
| 1230793200000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 7                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 11                 | 28                  | 28                  | 28                  | 9                  | 1                   | 35                | 0.00000         | 1013              | 26            | 10                  | 89                | 7                   | 1                |
| 1230796800000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 7                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 11                 | 28                  | 28                  | 29                  | 9                  | 2                   | 32                | 0.00000         | 1012              | 27            | 10                  | 102               | 8                   | 1                |
| 1230800400000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 7                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 10                 | 28                  | 28                  | 29                  | 9                  | 3                   | 30                | 0.00000         | 1011              | 27            | 10                  | 116               | 8                   | 1                |
| 1230804000000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 7                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 11                 | 27                  | 27                  | 28                  | 8                  | 2                   | 37                | 0.00000         | 1011              | 25            | 10                  | 107               | 7                   | 1                |
| 1230807600000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 6                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 13                 | 26                  | 26                  | 26                  | 7                  | 1                   | 44                | 0.00000         | 1011              | 23            | 10                  | 98                | 5                   | 1                |
| 1230811200000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 6                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 14                 | 25                  | 26                  | 25                  | 6                  | 0                   | 51                | 0.00000         | 1011              | 21            | 10                  | 88                | 4                   | 1                |
| 1230814800000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 6                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 14                 | 23                  | 23                  | 23                  | 10                 | 2                   | 57                | 0.00000         | 1012              | 20            | 10                  | 90                | 5                   | 1                |
| 1230818400000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 5                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 13                 | 21                  | 21                  | 21                  | 14                 | 3                   | 62                | 0.00000         | 1014              | 19            | 10                  | 91                | 7                   | 1                |
| 1230822000000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 5                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 12                 | 18                  | 18                  | 18                  | 17                 | 5                   | 67                | 0.00000         | 1015              | 17            | 10                  | 92                | 8                   | 1                |
| 1230825600000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 13                 | 18                  | 18                  | 18                  | 20                 | 7                   | 73                | 0.00000         | 1015              | 17            | 10                  | 94                | 9                   | 1                |
| 1230829200000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 13                 | 17                  | 17                  | 17                  | 22                 | 9                   | 79                | 0.00000         | 1015              | 17            | 10                  | 96                | 10                  | 1                |
| 1230832800000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 14                 | 17                  | 17                  | 17                  | 24                 | 11                  | 85                | 0.00000         | 1015              | 16            | 10                  | 98                | 12                  | 1                |
| 1230836400000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 14                 | 16                  | 16                  | 16                  | 22                 | 41                  | 89                | 0.00000         | 1015              | 16            | 7                   | 99                | 11                  | 1                |
| 1230840000000      | 27                | 12                | 0.00000             | 11.60000          | 5                   | 1                   | 31                         | 25080000          | 68580000         | 13320000         | 54300000        | 15                 | 16                  | 16                  | 16                  | 21                 | 70                  | 94                | 0.00000         | 1015              | 16            | 3                   | 100               | 11                  | 1                |
| 1230843600000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 16                  | 16                  | 16                  | 19                 | 100                 | 98                | 0.00000         | 1015              | 16            | 0                   | 101               | 10                  | 1                |
| 1230847200000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 16                  | 16                  | 16                  | 14                 | 96                  | 98                | 0.00000         | 1015              | 16            | 1                   | 91                | 8                   | 1                |
| 1230850800000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 17                  | 17                  | 17                  | 9                  | 92                  | 97                | 0.00000         | 1014              | 16            | 1                   | 81                | 6                   | 1                |
| 1230854400000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 17                  | 17                  | 17                  | 4                  | 89                  | 96                | 0.00000         | 1014              | 17            | 2                   | 71                | 3                   | 1                |
| 1230858000000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 18                  | 18                  | 18                  | 5                  | 71                  | 92                | 0.00000         | 1015              | 17            | 5                   | 86                | 4                   | 1                |
| 1230861600000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 18                  | 18                  | 18                  | 5                  | 54                  | 89                | 0.00000         | 1016              | 17            | 7                   | 101               | 4                   | 1                |
| 1230865200000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 5                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 18                  | 18                  | 18                  | 6                  | 36                  | 85                | 0.00000         | 1016              | 18            | 10                  | 116               | 5                   | 1                |
| 1230868800000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 6                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 15                 | 21                  | 21                  | 21                  | 6                  | 26                  | 71                | 0.00000         | 1016              | 20            | 10                  | 105               | 5                   | 1                |
| 1230872400000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 6                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 14                 | 24                  | 24                  | 24                  | 7                  | 16                  | 57                | 0.00000         | 1016              | 23            | 10                  | 94                | 6                   | 1                |
| 1230876000000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 7                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 13                 | 27                  | 27                  | 27                  | 7                  | 7                   | 43                | 0.00000         | 1015              | 26            | 10                  | 83                | 6                   | 1                |
| 1230879600000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 7                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 13                 | 27                  | 27                  | 27                  | 8                  | 6                   | 40                | 0.00000         | 1014              | 26            | 10                  | 94                | 7                   | 1                |
| 1230883200000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 7                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 12                 | 27                  | 27                  | 28                  | 8                  | 6                   | 38                | 0.00000         | 1013              | 27            | 10                  | 106               | 7                   | 1                |
| 1230886800000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 7                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 11                 | 28                  | 28                  | 28                  | 9                  | 5                   | 35                | 0.00000         | 1012              | 27            | 10                  | 117               | 8                   | 1                |
| 1230890400000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 7                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 12                 | 27                  | 27                  | 27                  | 10                 | 5                   | 40                | 0.00000         | 1012              | 26            | 10                  | 111               | 8                   | 1                |
| 1230894000000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 6                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 13                 | 26                  | 26                  | 26                  | 11                 | 5                   | 46                | 0.00000         | 1012              | 25            | 10                  | 105               | 8                   | 1                |
| 1230897600000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 6                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 14                 | 25                  | 25                  | 24                  | 13                 | 5                   | 51                | 0.00000         | 1012              | 23            | 10                  | 99                | 8                   | 1                |
| 1230901200000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 6                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 14                 | 23                  | 24                  | 23                  | 15                 | 9                   | 58                | 0.00000         | 1013              | 22            | 10                  | 101               | 8                   | 1                |
| 1230904800000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 6                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 14                 | 21                  | 22                  | 21                  | 17                 | 12                  | 64                | 0.00000         | 1014              | 21            | 10                  | 103               | 9                   | 1                |
| 1230908400000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 5                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 14                 | 20                  | 20                  | 20                  | 19                 | 16                  | 71                | 0.00000         | 1014              | 19            | 10                  | 105               | 10                  | 1                |
| 1230912000000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 15                 | 19                  | 19                  | 19                  | 19                 | 28                  | 74                | 0.00000         | 1015              | 19            | 10                  | 103               | 11                  | 1                |
| 1230915600000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 15                 | 19                  | 19                  | 19                  | 20                 | 40                  | 78                | 0.00000         | 1015              | 19            | 10                  | 101               | 12                  | 1                |
| 1230919200000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 19                  | 19                  | 19                  | 20                 | 52                  | 81                | 0.00000         | 1016              | 19            | 10                  | 99                | 13                  | 1                |
| 1230922800000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 18                  | 18                  | 18                  | 20                 | 50                  | 86                | 0.00000         | 1015              | 18            | 7                   | 103               | 13                  | 1                |
| 1230926400000      | 27                | 16                | 0.00000             | 11.60000          | 5                   | 1                   | 38                         | 27240000          | 71460000         | 13320000         | 54300000        | 16                 | 18                  | 18                  | 18                  | 20                 | 48                  | 90                | 0.00000         | 1015              | 18            | 5                   | 107               | 12                  | 1                |
| 1230930000000      | 25                | 15                | 0.00000             | 11.60000          | 5                   | 1                   | 45                         | 29460000          | 74400000         | 13320000         | 54360000        | 16                 | 17                  | 17                  | 17                  | 19                 | 46                  | 94                | 0.00000         | 1015              | 17            | 2                   | 111               | 12                  | 1                |
| 1230933600000      | 25                | 15                | 0.00000             | 11.60000          | 5                   | 1                   | 45                         | 29460000          | 74400000         | 13320000         | 54360000        | 16                 | 17                  | 17                  | 17                  | 16                 | 64                  | 96                | 0.00000         | 1015              | 16            | 1                   | 104               | 9                   | 1                |
+--------------------+-------------------+-------------------+---------------------+-------------------+---------------------+---------------------+----------------------------+-------------------+------------------+------------------+-----------------+--------------------+---------------------+---------------------+---------------------+--------------------+---------------------+-------------------+-----------------+-------------------+---------------+---------------------+-------------------+---------------------+------------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Create table for the dataset partitioned by the city_id
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE dataset_part (
. . . . . . . . . . . . . . . . . . . . . . .>     date_time TIMESTAMP,
. . . . . . . . . . . . . . . . . . . . . . .>     max_temp INT,
. . . . . . . . . . . . . . . . . . . . . . .>     min_temp INT,
. . . . . . . . . . . . . . . . . . . . . . .>     total_snow DECIMAL(10, 5),
. . . . . . . . . . . . . . . . . . . . . . .>     sun_hour DECIMAL(10, 5),
. . . . . . . . . . . . . . . . . . . . . . .>     uv_index_1 INT,
. . . . . . . . . . . . . . . . . . . . . . .>     uv_index_2 INT,
. . . . . . . . . . . . . . . . . . . . . . .>     moon_illumunation INT,
. . . . . . . . . . . . . . . . . . . . . . .>     moonrise STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     moonset STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     sunrise STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     sunset STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     dew_point INT,
. . . . . . . . . . . . . . . . . . . . . . .>     feels_like INT,
. . . . . . . . . . . . . . . . . . . . . . .>     heat_index INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_chill INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_gust INT,
. . . . . . . . . . . . . . . . . . . . . . .>     cloudcover INT,
. . . . . . . . . . . . . . . . . . . . . . .>     humidity INT,
. . . . . . . . . . . . . . . . . . . . . . .>     precip DECIMAL(10, 5),
. . . . . . . . . . . . . . . . . . . . . . .>     pressure INT,
. . . . . . . . . . . . . . . . . . . . . . .>     temp INT,
. . . . . . . . . . . . . . . . . . . . . . .>     visibility INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_dir INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_speed INT
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (city_id INT)
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS AVRO
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION 'project/hive/warehouse/dataset_part'
. . . . . . . . . . . . . . . . . . . . . . .> TBLPROPERTIES ('avro.compress'='SNAPPY');
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Change the configuratioins to allow dynamic partition
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SET hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Setting the Execution Engine to MapReduce
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- SET hive.execution.engine=mr;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> --Insert our data to the partitioned table
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO dataset_part partition (city_id) SELECT * FROM dataset;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Create table with bucketing
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE dataset_part_buck (
. . . . . . . . . . . . . . . . . . . . . . .>     date_time TIMESTAMP,
. . . . . . . . . . . . . . . . . . . . . . .>     max_temp INT,
. . . . . . . . . . . . . . . . . . . . . . .>     min_temp INT,
. . . . . . . . . . . . . . . . . . . . . . .>     total_snow DECIMAL(10, 5),
. . . . . . . . . . . . . . . . . . . . . . .>     sun_hour DECIMAL(10, 5),
. . . . . . . . . . . . . . . . . . . . . . .>     uv_index_1 INT,
. . . . . . . . . . . . . . . . . . . . . . .>     uv_index_2 INT,
. . . . . . . . . . . . . . . . . . . . . . .>     moon_illumunation INT,
. . . . . . . . . . . . . . . . . . . . . . .>     moonrise STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     moonset STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     sunrise STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     sunset STRING,
. . . . . . . . . . . . . . . . . . . . . . .>     dew_point INT,
. . . . . . . . . . . . . . . . . . . . . . .>     feels_like INT,
. . . . . . . . . . . . . . . . . . . . . . .>     heat_index INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_chill INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_gust INT,
. . . . . . . . . . . . . . . . . . . . . . .>     cloudcover INT,
. . . . . . . . . . . . . . . . . . . . . . .>     humidity INT,
. . . . . . . . . . . . . . . . . . . . . . .>     precip DECIMAL(10, 5),
. . . . . . . . . . . . . . . . . . . . . . .>     pressure INT,
. . . . . . . . . . . . . . . . . . . . . . .>     temp INT,
. . . . . . . . . . . . . . . . . . . . . . .>     visibility INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_dir INT,
. . . . . . . . . . . . . . . . . . . . . . .>     wind_speed INT
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> PARTITIONED BY (city_id INT)
. . . . . . . . . . . . . . . . . . . . . . .> CLUSTERED BY (date_time) INTO 10 BUCKETS
. . . . . . . . . . . . . . . . . . . . . . .> STORED AS AVRO
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION 'project/hive/warehouse/dataset_part_buck'
. . . . . . . . . . . . . . . . . . . . . . .> TBLPROPERTIES ('avro.compress'='SNAPPY');
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> --Insert our data to the partitioned table with bucketing
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO dataset_part_buck partition (city_id) SELECT * FROM dataset;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Drop the original dataset table
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- The tables with partitions and buckets will be used in the next steps
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS dataset;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 