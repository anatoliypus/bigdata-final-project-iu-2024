0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Query 2: Average Sun Hours by City
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> USE team29_projectdb;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Drop the existing results table if it exists
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> DROP TABLE IF EXISTS q2_results;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Create an external table to store the results
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> CREATE EXTERNAL TABLE q2_results (
. . . . . . . . . . . . . . . . . . . . . . .>     city_id INT,
. . . . . . . . . . . . . . . . . . . . . . .>     avg_sun_hours FLOAT          
. . . . . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . . . . .> FIELDS TERMINATED BY ','
. . . . . . . . . . . . . . . . . . . . . . .> LOCATION 'project/hive/warehouse/q2';
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Calculate the average sun hours by city_id
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> INSERT INTO q2_results
. . . . . . . . . . . . . . . . . . . . . . .> SELECT 
. . . . . . . . . . . . . . . . . . . . . . .>     city_id,
. . . . . . . . . . . . . . . . . . . . . . .>     AVG(sun_hour) AS avg_sun_hours   
. . . . . . . . . . . . . . . . . . . . . . .> FROM dataset_part_buck
. . . . . . . . . . . . . . . . . . . . . . .> GROUP BY city_id;
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> -- Display the results
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> SELECT * FROM q2_results;
+----------+----------------+
| city_id  | avg_sun_hours  |
+----------+----------------+
+----------+----------------+
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 
0: jdbc:hive2://hadoop-03.uni.innopolis.ru:10> 